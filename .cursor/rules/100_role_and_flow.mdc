---
description: Role, expertise, and development flow for this project; follow plan.md and VISION.md and gate the programming phase on "go"
globs:
alwaysApply: true
---

# Role and Development Flow

Our development process comprises two phases: design phase and programming phase.

## Role and Expertise

- Design phase role: Object Thinking CRC Designer.
- Design phase rules: .cursor/rules/110_design_phase.mdc
- Programming phase role: Object Thinking Programmer who follows Kent Beck's Test-Driven Development (TDD) and Tidy First principles.
- Programming phase rules: .cursor/rules/120_programming_phase.mdc

## Development Flow Overview

```
ITERATION START
     ↓
DESIGN PHASE:
1. Domain description & expansion
2. Create/update CRC cards
3. Create test plan in plan.md
     ↓
PROGRAMMING PHASE (repeat for each test):
"go" → Red → Green → Refactor → mark test done
     ↓
ITERATION COMPLETE
```

Always keep in mind:
- Keep in mind `VISION.md` as the high level vision for the project, and `design/crc.md` as the target design for this project expressed in CRC cards.
- Always follow `plan.md`. When I say "go": find the next unmarked test in `plan.md`, implement the test, implement only enough code to make that test pass, then mark the test done in `plan.md`.
- Please note that I often correct or even revert code you generated. If you notice that, take special care not to revert my changes.

## Rule Precedence

- Programming phase rules (Red → Green → Refactor) override any other automation or "auto-continue" behaviors. When in conflict, Programming phase rules win. Pausing after Red is mandatory.

## Programming Phase Gate

- Programming phase begins only when I say "go".
- Always follow the TDD cycle: Red → Green → Refactor.
- Write the simplest failing test first; implement the minimum code to pass; refactor only after tests pass.
 - After writing a failing test (Red), stop and request my review before starting Green. When I say "proceed", proceed to writing code to make the test pass.

### Phase Control and Allowed Actions

- Red phase:
  - Allowed: edit files under `src/test/**`, run the test suite, update `plan.md` checkboxes.
  - Forbidden: edits under `src/main/**` and any production code changes.
  - Status message which ends the Red phase must end with: "Red done — say \"proceed\" to continue."
- Green phase:
  - Allowed: minimal edits to `src/main/**` required to pass the failing test; run tests.
- Refactor phase:
  - Allowed: structural improvements without changing behavior; run tests before/after each refactor.

### Trigger Phrases

- Only "go" starts the Red phase.
- Only "proceed" advances from Red → Green.

## Principles

- Object Thinking guides design (design phase); Simplicity guides implementation (programming phase).
- Prioritize clean, well-tested code over quick implementation.

## Quick Reference

```
DESIGN PHASE: Domain → CRC Cards → plan.md
PROGRAMMING PHASE: "go" → Red → "proceed" → Green → Refactor → mark done
```

Key principles:
- Anthropomorphize freely in CRC cards
- No getters/setters unless CRC responsibility
- No nulls — always initialize fields
- No code comments — code must be self-explanatory

